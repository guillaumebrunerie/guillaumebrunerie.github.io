import{r as S,j as x}from"./index-7ae7ecba.js";const j=(M,l)=>{const n=M.map($=>1+($-.5)*.1),a=l.map($=>1+($-.5)*.1),o=.4*n[4]+(.4*n[4]-.5*n[2])*.5*n[6],t=.1*n[5]+(.1*n[5]- -.15*n[3])*.5*n[6],d=.4*a[4]+(.4*a[4]-.5*a[2])*.5*a[6],p=.1*a[5]+(.1*a[5]- -.15*a[3])*.5*a[6];return["C",[.1*n[0],-.05*n[1]],[.5*n[2],-.15*n[3]],[.4*n[4],.1*n[5]],"C",[o,t],[1-d,p],[1-.4*a[4],.1*a[5]],"C",[1-.5*a[2],-.15*a[3]],[1-.1*a[0],-.05*a[1]],[1,0]]},g=["L",[1,0]],m=(M,l,u,r,i,h)=>{const e=u-M,c=r-l,s=Math.sqrt(e*e+c*c),n=Math.atan2(c,e),a=t=>Number(t.toFixed(5)),o=(t,d,p)=>`${a(M+s*(t*Math.cos(n)-p*d*Math.sin(n)))},${a(l+s*(t*Math.sin(n)+p*d*Math.cos(n)))}`;return h.map(t=>typeof t=="string"?t:o(t[0],t[1],i)).join(" ")},f=(M,l,u,r,i,h,e,c)=>{const s=Math.cos(r*Math.PI/2-Math.PI/2-Math.PI/4)*Math.SQRT2*M/2+i.dx*M,n=Math.sin(r*Math.PI/2-Math.PI/2-Math.PI/4)*Math.SQRT2*l/2+i.dy*l,a=Math.cos(r*Math.PI/2-Math.PI/4)*Math.SQRT2*M/2+h.dx*M,o=Math.sin(r*Math.PI/2-Math.PI/4)*Math.SQRT2*l/2+h.dy*l;switch(u){case"-":return m(s,n,a,o,1,g);case"^":return m(s,n,a,o,-1,j(e,c));case"v":return m(s,n,a,o,1,j(e,c))}},v=(M,l,u,r,i,h,e,c)=>S.memo(({pieceId:s})=>{if(s==="background")return null;const n=M/u,a=l/r,[o,t]=s.split("_").map(R=>Number(R)),d=(o+t)%2==1?"^":"v",p=(o+t)%2==1?"v":"^",$=o==0?"-":c[o][t][0]?p:d,y=o==u-1?"-":c[o+1][t][0]?p:d,_=t==0?"-":c[o][t][1]?d:p,k=t==r-1?"-":c[o][t+1][1]?d:p,{dx:b,dy:I}=h[o][t],P=`M ${-n/2+b*n},${-a/2+I*a}                    ${f(n,a,_,0,h[o][t],h[o+1][t],e[o][t][1],e[o+1][t][3])}                    ${f(n,a,y,1,h[o+1][t],h[o+1][t+1],e[o+1][t][2],e[o+1][t+1][0])}                    ${f(n,a,k,2,h[o+1][t+1],h[o][t+1],e[o+1][t+1][3],e[o][t+1][1])}                    ${f(n,a,$,3,h[o][t+1],h[o][t],e[o][t+1][0],e[o][t][2])} z`;return x.jsxs("g",{children:[x.jsx("clipPath",{id:`piece_${s}`,children:x.jsx("path",{d:P})}),x.jsx("g",{clipPath:`url(#piece_${s})`,children:x.jsx("image",{href:i,width:M,height:l,x:-(o+1/2)*n,y:-(t+1/2)*a})}),x.jsx("path",{d:P,stroke:"#333",strokeWidth:"1px",fill:"none"})]})}),C=(M,l,u,r)=>{const i=[],h=M/u,e=l/r;for(let c=0;c<u;c++)for(let s=0;s<r;s++){const n=`${c}_${s}`;c<u-1&&i.push({from:n,to:`${c+1}_${s}`,rotation:0,dx:h,dy:0}),c>0&&i.push({from:n,to:`${c-1}_${s}`,rotation:0,dx:-h,dy:0}),s<r-1&&i.push({from:n,to:`${c}_${s+1}`,rotation:0,dx:0,dy:e}),s>0&&i.push({from:n,to:`${c}_${s-1}`,rotation:0,dx:0,dy:-e})}return i},X=({name:M,width:l,height:u,n:r,m:i,file:h})=>{const e=Array(r).fill(null).flatMap((o,t)=>Array(i).fill(null).map((d,p)=>`${t}_${p}`)),c=.1,s=[],n=[],a=[];for(let o=0;o<=r;o++){s[o]=[],n[o]=[],a[o]=[];for(let t=0;t<=i;t++){s[o][t]={dx:o==0||o==r?0:(Math.random()-.5)*c,dy:t==0||t==i?0:(Math.random()-.5)*c};const d=()=>Array(7).fill(null).map(()=>Math.random());n[o][t]=[d(),d(),d(),d()],a[o][t]=[Math.random()>.7,Math.random()>.7]}}return{name:M,width:l*1.3,height:u*1.3,rotations:4,pieces:e,connections:C(l,u,r,i),globalRestrictions:()=>!0,Background:()=>null,Piece:v(l,u,r,i,h,s,n,a)}};export{X as default};
